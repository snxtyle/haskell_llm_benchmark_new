module Triangle (rows) where

rows :: Int -> [[Integer]]
rows n
    | n <= 0    = []
    | otherwise = take n pascalSequence
    where
        -- pascalSequence generates an infinite list of Pascal's triangle rows.
        -- It starts with the first row, [1].
        -- Subsequent rows are generated by applying generateNextRow to the previous row.
        pascalSequence :: [[Integer]]
        pascalSequence = iterate generateNextRow [1]

        -- generateNextRow computes the next row of Pascal's triangle from the previous one.
        generateNextRow :: [Integer] -> [Integer]
        generateNextRow prevRow = 1 : zipWith (+) prevRow (tail prevRow) ++ [1]
        -- Example:
        -- If prevRow is [1, 2, 1]:
        --   tail prevRow is [2, 1].
        --   zipWith (+) prevRow (tail prevRow) calculates sums of adjacent elements:
        --     [ (1+2), (2+1) ] which is [3, 3].
        --   The new row is constructed by adding 1 at the beginning and end:
        --     1 : [3, 3] ++ [1]  which results in [1, 3, 3, 1].

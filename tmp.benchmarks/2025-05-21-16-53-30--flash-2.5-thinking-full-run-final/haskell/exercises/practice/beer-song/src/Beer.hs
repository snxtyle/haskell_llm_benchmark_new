module Beer (song) where

-- Helper function to get the correct phrase for the number of bottles.
bottlePhrase :: Int -> String
bottlePhrase 0 = "no more bottles"
bottlePhrase 1 = "1 bottle"
bottlePhrase n = show n ++ " bottles"

-- Helper function to get the correct action phrase.
actionPhrase :: Int -> String
actionPhrase 1 = "Take it down and pass it around"
actionPhrase _ = "Take one down and pass it around"

-- Generates a single verse of the song.
-- Handles the special case for 0 bottles (the last verse).
verse :: Int -> String
verse 0 = "No more bottles of beer on the wall, no more bottles of beer.\n" ++
          "Go to the store and buy some more, 99 bottles of beer on the wall."
verse n =
    let
        currentBottles = bottlePhrase n
        nextBottles = bottlePhrase (n - 1)
        action = actionPhrase n
        -- The core two lines of the verse
        verseLines = currentBottles ++ " of beer on the wall, " ++ currentBottles ++ " of beer.\n" ++
                     action ++ ", " ++ nextBottles ++ " of beer on the wall."
    in
        -- Add an extra newline for separation between verses
        verseLines ++ "\n"

-- The complete song, generated by combining individual verses.
song :: String
song = unlines $ map verse [99, 98 .. 1] ++ [verse 0]
